```{asis index-2, echo=knitr::is_latex_output()}
\mainmatter
```

# Wprowadzenie{#intro}

```{r, include=FALSE}
source("code/before_script.R")
```

Książka ta dotyczy wykorzystania możliwości komputerów do*pracy*z danymi geograficznymi.Uczy
ona szeregu umiejętności związanych z przestrzenią, w tym: czytania, pisania i manipulowania formatami plików geograficznych; tworzenia statycznych i interaktywnych map; oraz stosowania geokomputacji\\indeksu{geocomputation}w celu wspierania bardziej opartego na dowodach procesu podejmowania decyzji związanych z szeregiem zjawisk geograficznych, od systemów transportowych po ekosystemy.
Pokazując, w jaki sposób można połączyć różne operacje geograficzne, w „fragmentach kodu” przeplatających się z tekstem, książka uczy również powtarzalnych, otwartych, a tym samym naukowych procesów pracy.

Książka nie dotyczy tylko wykorzystania bogactwa*istniejących narzędzi*do geokomputacji: dotyczy również zrozumienia struktur danych geograficznych i oprogramowania potrzebnego do tworzenia*nowych narzędzi*.
Podejście, którego uczymy w całej książce, aw szczególnościtechniki programowania omówione{algorithm}w rozdziale @ref(algorithms)\\index, mogą usunąć ograniczenia kreatywności narzucone przez oprogramowanie.
Po przeczytaniu książki i wykonaniu ćwiczeń powinieneś być gotowy do rozwiązania rzeczywistych problemów, przedstawienia swojej pracy na mapach i w kodzie oraz wniesienia wkładu w społeczności open source opracowujące narzędzia i dokumentację do powtarzalnych obliczeń geograficznych.

W ciągu ostatnich kilku dekad darmowe i otwarte oprogramowanie do przetwarzania danych geoprzestrzennych (FOSS4G\\index{FOSS4G}) rozwijało się w zadziwiającym tempie.
Dzięki organizacjom takim jak OSGeo zaawansowane techniki geograficzne nie są już zarezerwowane dla osób posiadających drogi sprzęt i oprogramowanie: każdy może teraz pobrać i uruchomić wysokowydajne oprogramowanie do geocomputation.
Systemy informacji geograficznej (GIS\\index{GIS})typu open source, takie jak[QGIS](https://qgis.org/en/site/)\\index{QGIS}, sprawiły, że analiza geograficzna stała się dostępna na całym świecie.
Oprogramowanie GIS jest potężnym narzędziem, ale zazwyczaj kładzie większy nacisk na graficzny interfejs użytkownika\\index{graphical user interface}(GUI) niż na interfejs wiersza poleceń (CLI), który jest zalecany w niniejszej książce.
„Nacisk na GUI” wielu produktów GIS ma niezamierzoną konsekwencję w postaci uniemożliwienia wielu użytkownikom pełnej reprodukowalności ich pracy\\index{reproducibility}, problem ten można jednak rozwiązać, wywołując „geoalgorytmy” zawarte w oprogramowaniu GIS z poziomu wiersza poleceń, co zobaczymy w rozdziale @ref(gis).
Uproszczone porównanie różnych podejść przedstawiono w tabeli @ref(tab:gdsl).

```{r gdsl, echo=FALSE, message=FALSE}
d = readr::read_csv("extdata/gis-vs-gds-table.csv")
knitr::kable(x = d,
             caption = paste("Differences in emphasis between software", 
                             "packages (Graphical User Interface (GUI) of", 
                             "Geographic Information Systems (GIS) and R)."),
             caption.short = "Differences between GUI and CLI",
             booktabs = TRUE)
```

R nie jest jedynym językiem zapewniającym CLI do geocomputation.
Istnieją inne środowiska poleceń o potężnych możliwościach geograficznych, w tym Python\\index{Python}(omówiony w książce[Geocomputation with Python](https://py.geocompx.org/)), Julia i JavaScript.
Jednak R ma zalety, które sprawiają, że jest dobrym językiem do nauki geocomputation i do wielu zadań geocomputation, zwłaszcza do statystyki, modelowania i wizualizacji, jak opisano w sekcji @ref(why-open-source).

Motywacją do napisania tej książki jest również{reproducibility}znaczenie odtwarzalnościdla badań naukowych.
Jej celem jest ułatwieniedostępudo{geographic data analysis}odtwarzalnychprocesówanalizy danych geograficznychoraz pokazanie możliwości otwartego oprogramowania geoprzestrzennego dostępnego z poziomu wiersza poleceń.
 R zapewnia sposoby łączenia się z innymi językami [@eddelbuettel_extending_2018] , umożliwiając wywoływanie wielu bibliotek oprogramowania przestrzennego z poziomu R, jak wyjaśniono w sekcji @ref(why-use-r-for-geocomputation) i pokazano w rozdziale @ref(gis).
Zanim jednak przejdziemy do szczegółów dotyczących oprogramowania, warto cofnąć się o krok i zastanowić się, co rozumiemy pod pojęciem geocomputation\\index{geocomputation}.

```{block2 01-introduction-1, type="rmdnote"}
Reproducibility is a major advantage of command-line interfaces, but what does it mean in practice?
We define it as follows: "A process in which the same results can be generated by others using publicly accessible code".
This may sound simple and easy to achieve (which it is if you carefully maintain your R code in script files), but it has profound implications for teaching and the scientific process [@pebesma_r_2012].
```

\\index{reproducibility}

## Czym jest geokomputacja?

Geokomputację definiujemy jako

> Badania naukowe, tworzenie oprogramowania i praktyczne zastosowania wykorzystujące dane geograficzne do rozwiązywania problemów, z naciskiem na powtarzalność, elastyczność i rozwój narzędzi.

Geocomputation\\index{geocomputation!definition}to młody termin, którego początki sięgają pierwszej konferencji poświęconej tej tematyce w 1996 roku.^\[
Pierwsza konferencja „GeoComputation” odbyła się na Uniwersytecie w Leeds, gdzie obecnie pracuje jeden z autorów (Robin).
W 2017 r. konferencja GeoComputation powróciła na Uniwersytet w Leeds, dając nam możliwość pracy nad książką i jej prezentacji (więcej informacji na temat serii konferencji oraz artykułów/prezentacji z ponad dwóch dekad można znaleźć na stronie www.geocomputation.org).
\]
 To, co odróżniało geocomputation od powszechnie używanego wówczas terminu „geografia ilościowa”, to nacisk na „kreatywne i eksperymentalne” zastosowania [@longley_geocomputation_1998] oraz opracowywanie nowych narzędzi i metod.
 Według słów Stana Openshawa, pioniera w tej dziedzinie, który był zwolennikiem (i prawdopodobnie twórcą) tego terminu, „geokomputacja polega na wykorzystaniu różnych rodzajów danych geograficznych i opracowywaniu odpowiednich narzędzi geograficznych w ogólnym kontekście podejścia „naukowego” [@openshaw_geocomputation_2000] .
Opierając się na tej wczesnej definicji,*geocomputation z wykorzystaniem języka R*wykracza poza analizę danych i modelowanie, obejmując opracowywanie nowych narzędzi i metod do pracy, która jest nie tylko interesująca z akademickiego punktu widzenia, ale także przynosi korzyści.

Nasze podejście różni się jednak od wczesnych definicji geocomputation w jednym ważnym aspekcie: kładzie nacisk na odtwarzalnośći{reproducibility}współpracę.
Na przełomie XXI wieku nierealistyczne było oczekiwanie, że czytelnicy będą w stanie odtworzyć przykłady kodu, ze względu na bariery uniemożliwiające dostęp do niezbędnego sprzętu, oprogramowania i danych.
Dzisiaj sytuacja uległa szybkiej zmianie.
Każdy,kto ma dostęp do laptopa z wystarczającą ilością pamięci RAM (zalecane co najmniej 8 GB), może zainstalować i uruchomić oprogramowanie do geokomputacji oraz odtworzyć zawartość tej książki.
Bariery finansowe i sprzętowe związane z geokomputacją, które istniały w latach 90. i na początku XXI wieku, kiedy komputery o wysokiej wydajności były zbyt drogie dla większości ludzi, zostały usunięte.^\[
Odpowiedni laptop można dziś nabyć z drugiej ręki za 100 dolarów lub mniej w większości krajów na stronach internetowych takich jak[Ebay](https://www.ebay.com/sch/i.html?_from=R40&_nkw=laptop&_sacat=0&_oaa=1&_udhi=100&rt=nc&RAM%2520Size=4%2520GB%7C16%2520GB%7C8%2520GB&_dcat=177).
Wskazówki dotyczące instalacji R i odpowiedniego edytora kodu znajdują się w rozdziale @ref(spatial-class).
\]
Geocomputation jest również bardziej dostępne, ponieważ publicznie dostępne zbiory danych są szerzej dostępne niż kiedykolwiek wcześniej, co zobaczymy w rozdziale @ref(read-write).
W przeciwieństwie do wcześniejszych prac w tej dziedzinie, wszystkie prace przedstawione w tej książce można odtworzyć za pomocą kodu i przykładowych danych dostarczonych wraz z książką, wpakietach{R}R\\index,takich jak**spData**, których instalacja została omówiona w rozdziale @ref(spatial-class).

Geocomputation\\index{geocomputation} jest ściśle powiązane z innymi terminami, takimi jak: nauka o informacjach geograficznych (GIScience); geomatyka; geoinformatyka; nauka o informacjach przestrzennych; inżynieria [@longley_geographic_2015] geoinformacyjna ; oraz nauka o danych przestrzennych\index{spatial data science}\\index{geographical data science|see spatial data science}(SDS).
Każdy z tych terminów kładzie nacisk na „naukowe” (oznaczające powtarzalne i falsyfikowalne) podejście pod wpływem GIS\\index{GIS!definition}, chociaż ich pochodzenie i główne obszary zastosowania są różne.Na przykład
SDS kładzie nacisk na umiejętności w zakresie „nauki o danych” i duże zbiory danych, podczas gdy geoinformatyka koncentruje się raczej na strukturach danych.
Jednak podobieństwa między tymi terminami są większe niż różnice między nimi i używamy geocomputation jako ogólnego synonimu obejmującego je wszystkie:wszystkie
one mają na celu wykorzystanie danych geograficznych do prac naukowych o charakterze stosowanym.
W przeciwieństwie do pierwszych użytkowników tego terminu, nie sugerujemy jednak, że istnieje spójna dziedzina akademicka zwana „Geocomputation” (lub „GeoComputation”, jak nazwał ją Stan Openshaw).

Geokomputacja jest terminem nowym, ale pozostaje pod wpływem starych idei.
Można ją postrzegać jako część geografii\\index{geography} , która ma ponad 2000-letnią historię [@talbert_ancient_2014] ,
orazjakorozszerzenie GIS\\index
      \[@neteler\_open\_2008\]
    {GIS} , które pojawiło się w latach 60. [@coppock_history_1991] .

Geografia\\index{geography}odegrała ważną rolę w wyjaśnianiu i wpływie na relacje ludzkości ze światem przyrody na długo przed wynalezieniem komputera.
Słynny odkrywca, wczesny geograf i pionierski erudyta Alexander von Humboldt\\index{von Humboldt}(którego wpływ był tak duży, że dziesiątki gatunków, obiektów geograficznych, miejsc, a nawet uniwersytetów noszą jego imię) ilustruje tę rolę: jego podróże do Ameryki Południowej na
 początku XIX wieku i wynikające z nich obserwacje nie tylko położyły podwaliny pod geografię fizyczną i ekologię, ale także utorowały drogę do polityki ochrony świata przyrody [@wulf_invention_2015] .
 Niniejsza książka ma na celu wniesienie wkładu w wciąż ewoluującą „tradycję geograficzną” [@livingstone_geographical_1992] poprzez wykorzystanie możliwości nowoczesnych komputerów i oprogramowania open source.

Związki książki ze starszymi dyscyplinami znalazły odzwierciedlenie w proponowanych tytułach:*„Geografia z R*”i*„R dla GIS*”.
Każdy znich ma swoje zalety.
Pierwszy z nich oddaje praktyczny charakter treści, wykraczający poza samo wskazanie położenia na mapie.
Drugi sugeruje, że jest to książka o wykorzystaniu R jako potężnego systemu informacji geograficznej z wierszem poleceń do wykonywania operacji przestrzennych na*danych geograficznych*.
Jednak termin GIS ma konotacje, które nie oddają niektórych znajwiększych{R}zaletjęzyka R:
jego zdolności do płynnego przełączania się między przetwarzaniem danych geograficznych i niegeograficznych, modelowaniem i wizualizacją, przy jednoczesnym umożliwieniu odtwarzalności znacznie wykraczającej poza możliwości GIS.
Geocomputation\\index{geocomputation}oznacza pracę z danymi geograficznymi w odtwarzalnym środowisku opartym na kodzie oraz programowanie nowych wyników, metod i narzędzi, co jest tematem tej książki.\\index{GIS!connotations}

## Dlaczego warto korzystać z narzędzi open source do geokomputacji?{#why-open-source}

Pierwsi geografowie używali różnych narzędzi, takich jak barometry, kompasy i[sekstanty,](https://en.wikipedia.org/wiki/Sextant) aby poszerzać wiedzę o świecie [@wulf_invention_2015] .
Dopiero wynalezienie[chronometru](https://en.wikipedia.org/wiki/Marine_chronometer)morskiegow 1761 r. umożliwiło obliczanie długości geograficznej na morzu, copozwoliło statkom na przykład wybierać bardziej bezpośrednie trasy.
Przed przełomem wieku istniał poważny niedobór danych i narzędzi do analizy geograficznej.

<!-- Korzystanie z sekstantu było trudne do opanowania

,

ale w XVIII wieku było niezbędnym narzędziem nawigacyjnym.
Podobnie nauka programowania, pisania i udostępniania powtarzalnego kodu może być trudna, ale jest kluczową umiejętnością we współczesnych obliczeniach geograficznych. -->

Obecnie naukowcy i praktycy nie mają takich ograniczeń, a w niektórych przypadkach borykają się z odwrotnym problemem: zbyt dużą ilością danych i zbyt wieloma narzędziami.
Większość telefonów posiada obecnieodbiornikglobalnego systemu pozycjonowania (GPS\\index{GPS}).
Czujniki, od satelitów i pojazdów półautonomicznych po naukowców-amatorów,nieustannie mierzą każdy zakątek świata.
Ilość generowanych danych może być przytłaczająca, a nowe technologie, takie jak pojazdy autonomiczne, generują codziennie setki, a nawet tysiące gigabajtów danych.Zbiory
danych{remote sensing}teledetekcyjnych\\indexz satelitów są zbyt duże, aby można je było analizować za pomocą jednego komputera, jak opisano w rozdziale @ref(gis).
Ta „rewolucja geodanych” napędza popyt na wysokowydajny sprzęt komputerowy oraz wydajne, skalowalne oprogramowanie do obsługi i wydobywania sygnału z szumu.
Ewolucyjne narzędzia open source mogą bezpośrednio importować i przetwarzać podzbiory z ogromnych magazynów danych geograficznych za pośrednictwem interfejsów programowania aplikacji (API) i interfejsów do baz danych. \\index{spatial database}

W obliczu szybko zmieniającego się środowiska sprzętu, oprogramowania i danych ważne jest, aby wybierać narzędzia, które są przyszłościowe.
Główną zaletą oprogramowania open source jest**tempo**jego**rozwoju i długowieczność**, a także tysiące potencjalnych współpracowników.
Każdego dnia setki osób zgłaszają błędy i sugerują nowe funkcje, a także ulepszenia dokumentacji do projektów open source — tempo ewolucji, z którym większość rozwiązań zastrzeżonych po prostu nie jest w stanie nadążyć.

Związaną z tym zaletą jest**interoperacyjność**.
Podczas gdy produkty zastrzeżone są zazwyczaj monolitycznymi „imperiami”, które trudno utrzymać (co wiąże się z wcześniej wspomnianą zaletą), oprogramowanie open source przypomina raczej „federację” modułowych narzędzi, które można łączyć na różne sposoby.
Dzięki temu języki open source wykorzystywane w naukach o danych, takie jak R, mogą szybko włączać nowe rozwiązania, takie jak interfejsy do wysokowydajnych bibliotek wizualizacji i formatów plików, podczas gdy rozwiązania własnościowe mają trudności z nadążaniem za tymi zmianami.

Kolejną ważną zaletą jest**powtarzalność**.
Możliwość powtórzenia wyników badań ma kluczowe znaczenie dla badań naukowych, a oprogramowanie open source usuwa ważną barierę powtarzalności, umożliwiając innym sprawdzenie wyników badań lub zastosowanie metod w nowych kontekstach przy użyciu tych samych narzędzi.
Połączenie narzędzi, do których każdy ma bezpłatny dostęp, z możliwością udostępniania kodu i danych oznacza, że wyniki pracy mogą być sprawdzane i wykorzystywane przez innych, co stanowi ogromną zaletę, jeśli chcesz, aby Twoja praca była wykorzystywana i cytowana.

Jednak dla wielu osób największą zaletą oprogramowania open source w połączeniu z udostępnianiem powtarzalnego kodu jest**społeczność**.
Społeczność umożliwia uzyskanie wsparcia znacznie szybciej i często o wyższej jakości niż jest to możliwe w przypadku scentralizowanego i ograniczonego budżetowo zespołu wsparcia związanego z oprogramowaniem własnościowym.
Społeczność może zapewnić informacje zwrotne, pomysły i, jak omówiono w rozdziale @ref(conclusion)), pomóc w opracowaniu własnych narzędzi i metod.

R jest projektem oprogramowania open source, potężnym językiem i stale ewoluującą społecznością statystyków i programistów [@wickham_advanced_2019] .
R nie jest jedynym językiem umożliwiającym powtarzalne obliczenia geograficzne za pomocą oprogramowania open source, jak opisano w sekcji @ref(software-for-geocomputation)).
Wiele powodów, dla których warto używać języka R, dotyczy również innych języków open source służących do powtarzalnej analizy danych, takich jak Python\\index{Python}i Julia.
Jednak język R ma kilka kluczowych zalet, jak opisano w sekcji @ref(why-use-r-for-geocomputation).

## Dlaczego warto używać języka R do obliczeń geograficznych?{#why-use-r-for-geocomputation}

R to wieloplatformowy język i środowisko typu open source służące do obliczeń statystycznych i tworzenia grafiki ([r-project.org/](https://www.r-project.org/)).
Dzięki szerokiej gamie pakietów język R obsługuje również zaawansowane statystyki geoprzestrzenne\\index{statistics}, modelowanie i wizualizację.
\\index{R!language}
Zintegrowane środowiska programistyczne (IDE\\index{IDE}),takie jak RStudio\\index,sprawiły, że{RStudio}język R stał się bardziej przyjazny dla wielu użytkowników, ułatwiając tworzenie map dzięki panelowi przeznaczonemu do interaktywnej wizualizacji.

W swej istocie R jest obiektowym,[funkcjonalnym językiem programowania](https://adv-r.hadley.nz/fp.html) [@wickham_advanced_2019] i został specjalnie zaprojektowany jako interaktywny interfejs do innego oprogramowania [@chambers_extending_2016] .
Ten ostatni zawiera również wiele „mostów” do skarbnicyoprogramowaniaGIS\\index,{GIS}„geobibliotek” i funkcji (patrz rozdział @ref(gis)).
Dzięki temu idealnie nadaje się do szybkiego tworzenia „narzędzi geograficznych” bez konieczności opanowania języków niższego poziomu (w porównaniu z R), takich jak C\\index{C}, FORTRAN\\index{FORTRAN}lub Java\\index{Java}(patrz sekcja @ref(software-for-geocomputation)).
\\indexMoże{R}
to sprawiać wrażenie uwolnienia się od metaforycznego „szklanego sufitu” narzuconego przez systemy informacji geograficznej oparte na GUI lub zastrzeżone (definicja GUI\\index znajduje się w{graphical user interface}tabeli @ref(tab:gdsl)).
Ponadto R ułatwia dostęp do innych języków:
pakiety**Rcpp**i**reticulate**umożliwiająna przykładdostęp dokoduC++\\{Python}index{C++}i Python\\index.
Oznacza to, że R może służyć jako „pomost” do szerokiej gamy programów geoprzestrzennych (zobacz sekcja @ref(software-for-geocomputation)).

Innym przykładem pokazującym elastyczność R i jego rozwijające się możliwości geograficzne jest interaktywne tworzenie map\\index{map-making!interactive maps}.
 Jak zobaczymy w rozdziale @ref(adv-map), stwierdzenie, że R ma „ograniczone możliwości interaktywnego [tworzenia] wykresów” nie [@bivand_applied_2013] jest już prawdziwe.
Świadczy o tym poniższy fragment kodu, który tworzy rysunek @ref(fig:interactive) (funkcje generujące wykres omówiono w sekcji @ref(interactive-maps)).

```{r 01-introduction-2, eval=FALSE, echo=FALSE}
a = osmdata::getbb("Hereford")
b = osmdata::getbb("Bialystok")
rowMeans(a)
rowMeans(b)
```

```{r interactive-demo, eval=FALSE}
library(leaflet)
popup = c("Robin", "Jakub", "Jannes")
leaflet() |>
  addProviderTiles("NASAGIBS.ViirsEarthAtNight2012") |>
  addMarkers(lng = c(-3, 23, 11),
             lat = c(52, 53, 49), 
             popup = popup)
```

```{r interactive, fig.cap="The blue markers indicate where the authors are from. The basemap is a tiled image of the Earthat night provided by NASA. Interact with the online version at r.geocompx.org, for example by zooming in and clicking on the pop-ups.", out.width="100%", fig.scap="Where the authors are from.", echo=FALSE}
if (knitr::is_latex_output()){
    knitr::include_graphics("images/interactive.png")
} else if (knitr::is_html_output()){
    # library(leaflet)
    # popup = c("Robin", "Jakub", "Jannes")
    # interactive = leaflet() |>
    #   addProviderTiles("NASAGIBS.ViirsEarthAtNight2012") |>
    #   addMarkers(lng = c(-3, 23, 11),
    #              lat = c(52, 53, 49), 
    #              popup = popup)  
    # library(htmlwidgets)
    # saveWidget(interactive, file = "interactive.html")
    # file.copy("interactive.html", "~/geocompr/geocompr.github.io/static/img/interactive.html")
    knitr::include_url("https://geocompr.github.io/img/interactive.html")
}
```

\\index

Kilka lat temu

{map-making!interactive}

trudno byłoby stworzyć rysunek @ref(fig:interactive) przy użyciu języka R (lub jakiegokolwiek innego języka open source przeznaczonego do analizy danych), nie mówiąc już o interaktywnej mapie.
Ilustruje to elastyczność języka R i pokazuje, jak dzięki takim rozwiązaniom jak**knitr**i**leaflet**może on służyć jako interfejs do innego oprogramowania, co będzie powracać w niniejszej książce.
Wykorzystanie kodu R umożliwia zatem nauczanie geokomputacji w oparciu o powtarzalne przykłady reprezentujące zjawiska występujące w świecie rzeczywistym, a nie tylko abstrakcyjne pojęcia.

„R-spatial stack” jest łatwy w instalacji i zawiera kompleksowe, dobrze utrzymane i wysoce interoperacyjne pakiety.
R ma „wbudowane baterie” z funkcjami statystycznymi jako część podstawowej instalacji oraz setki dobrze utrzymanych pakietów implementujących wiele najnowocześniejszych metod.
Dzięki R można zagłębić się w temat i uzyskać działające rozwiązania przy zaskakująco niewielkiej ilości linii kodu, co pozwala skupić się na metodach geograficznych i danych, a nie na debugowaniu i zarządzaniu zależnościami pakietów.
Szczególną zaletą języka R jest łatwość, z jaką pozwala on tworzyć interaktywne mapy o jakości publikacyjnej dzięki doskonałym pakietom mapującym, jak opisano w rozdziale @ref(adv-map).

## Oprogramowanie do geokomputacji

R jest potężnym językiem do obliczeń geograficznych, ale istnieje wiele innych opcji analizy danych geograficznych, zapewniających tysiące funkcji geograficznych\\index{function}.
Znajomość innych języków do obliczeń geograficznych pomoże zdecydować, kiedy inne narzędzie może być bardziej odpowiednie do konkretnego zadania, i umieści R w szerszym ekosystemie geoprzestrzennym.
W tej sekcji krótko przedstawiono języki[C++](https://isocpp.org/)\\index{C++},[Java](https://www.oracle.com/java/)\\index{Java}i[Python](https://www.python.org/)\\index{Python}do obliczeń geograficznych, w ramach przygotowań do rozdziału @ref(gis).

Ważną cechą języka R (i Python) jest to, że jest to język
interpretowany.Jest to korzystne, ponieważ umożliwia interaktywne programowanie w pętli Read–Eval–Print Loop (REPL):\\index{REPL}
kod wprowadzony do konsoli jest natychmiast wykonywany, a wynik jest drukowany, zamiast czekać na pośredni etap kompilacji.
Z drugiej strony, języki kompilowane, takie jak C++\\index{C++}i Java\\index{Java}, działają zazwyczaj szybciej (po skompilowaniu).

C++{C++}stanowi podstawę wielu pakietów GIS, takich jak[QGIS](https://www.qgis.org/en/site/){QGIS},[GRASS GIS](https://grass.osgeo.org/)i{GRASS GIS}[SAGA](https://saga-gis.sourceforge.io/),{SAGA}więc jest to rozsądny punkt wyjścia.
Dobrze napisany C++{C++}jest bardzo szybki, co czyni go dobrym wyborem dla aplikacji, w których kluczowa jest wydajność, takich jak przetwarzanie dużych zbiorów danych geograficznych, ale jest trudniejszy do nauczenia się niż Python lub R.
C++{C++}stał się bardziej dostępny dziękipakietowi**Rcpp**, który zapewniaużytkownikom Rdobre „wejście” doprogramowania{C}wC++.
Biegłość w posługiwaniu się takimi językami niskiego poziomu otwiera możliwość tworzenia nowych, wysokowydajnych „geoalgorytmów” i lepszego zrozumienia działania oprogramowania GIS (patrz rozdział @ref(algorytmy)).
Jednak nie jest konieczne nauka C++,{C++}aby używać R do geocomputation.

Python\\index{Python}jest ważnym językiem dla geocomputation, zwłaszcza że wiele programów Desktop GIS\\index,{GIS}takich jak{QGIS}GRASS GIS\\index{GRASS GIS}, SAGA\\index{SAGA}i QGIS\\index,zapewnia Python API\\index{API}(patrz rozdział @ref(gis)).
Podobnie jak R\\index{R}, Python jest popularnym językiem w nauce o danych.
Oba języki są zorientowane obiektowo i mają wiele wspólnych obszarów, co prowadzi do inicjatyw takich jakpakiet**reticulate**,który ułatwia dostęp do Python\\index{Python}z R, orazinicjatywa[Ursa Labs](https://ursalabs.org/)mająca na celu wsparcie przenośnych bibliotek z korzyścią dla całego ekosystemu nauki o danych open source.

W praktyce zarówno R, jak i Python mają swoje mocne strony.
W pewnym stopniu to, którego używasz, jest mniej ważne niż dziedzina zastosowania i komunikacja wyników.
Nauka jednego z nich zapewni przewagę w nauce drugiego.
Istnieją jednak znaczące zalety R\\index{R}w porównaniu z Python\\index{Python}w przypadku geocomputation\\index{geocomputation}.
Obejmuje to znacznie lepszą obsługę modelu danych rastrowych w samym języku (patrz rozdział @ref(spatial-class)) i odpowiednie możliwości wizualizacji (patrz rozdziały @ref(spatial-class) i @ref(adv-map)).
Równie ważne jest to{statistics}, że R ma niezrównane wsparcie dla statystyki, w tym statystyki{spatial!statistics}przestrzennej, z setkami pakietów (nieporównywalnych z Pythonem{Python}) obsługujących tysiące metod statystycznych.

Główną zaletą języka Python jest to, że jest tojęzyk programowania*ogólnego**przeznaczenia*.Jest
on używany w wielu dziedzinach, w tym w oprogramowaniu komputerowym, grach komputerowych, stronach internetowych i nauce o danych\\index{data science}.
Python\\index{Python}jest często jedynym wspólnym językiem dla różnych społeczności (geoinformatycznych) i można go postrzegać jako „klej”, który spaja wieleprogramówGIS{GIS}\\index.
Wiele geoalgorytmów{geoalgorithm}, w tym te w QGIS{QGIS}i ArcMap, jest dostępnych z poziomu wiersza poleceń Pythona, co sprawia, że język ten doskonale nadaje się jako język startowy dla GIS z wierszem poleceń.Moduły
Pythona zapewniające dostęp do geoalgorytmów{geoalgorithm}obejmują`grass.script`dla GRASS GIS,
`saga-python`{GRASS GIS}dla SAGA-GIS{SAGA},
`processing`dla QGIS{QGIS}i`arcpy`dla ArcGIS.{ArcGIS}


Jednakw przypadku statystyki{spatial!statistics}przestrzenneji modelowania predykcyjnego R nie ma sobie równych.Nie oznacza
to,że musisz wybierać między R a Pythonem: Python{Python}obsługuje większość popularnych technik statystycznych (chociaż R zazwyczaj szybciej obsługuje nowe rozwiązania w statystyce przestrzennej),a wiele koncepcji poznanych w Pythonie można zastosować wświecie{R}R.
Podobnie jak R, Python obsługuje również analizę i manipulację danymi geograficznymi za pomocą pakietów takich jak**shapely**,**geopandas**,**rasterio**i**xarray**.

## Ekosystem przestrzenny języka R{#r-ecosystem}

Istnieje wiele sposobów obsługi danych geograficznych w R, z dziesiątkami pakietów\\index{R-spatial}w tej dziedzinie.^\[
Przegląd ekosystemu przestrzennego R można znaleźć w CRAN\\index{CRAN}Task View on the Analysis of Spatial Data
(zobacz https://cran.r-project.org/view=Spatial).
\]
W niniejszej książce staramy się przedstawić najnowsze osiągnięcia w tej dziedzinie, zapewniając jednocześnie, że metody te będą aktualne również w przyszłości.
Podobnie jak wiele innych obszarów tworzenia oprogramowania, ekosystem przestrzenny języka R szybko się rozwija (rysunek @ref(fig:cranlogs)).
Ponieważ R jest oprogramowaniem typu open source, zmiany te mogą łatwo opierać się na wcześniejszych pracach, „stojąc na ramionach gigantów”, jak ujął to Isaac Newton w[1675 roku](https://digitallibrary.hsp.org/index.php/Detail/objects/9792).
Takie podejście jest korzystne, ponieważ zachęca do współpracy i pozwala uniknąć „wynajdywania koła na nowo”.Na przykład
pakiet**sf**\\index{sf}(omówiony w rozdziale @ref(spatial-class)) opiera się na swoim poprzedniku**sp**.

Wzrost czasu rozwoju (i zainteresowania) „R-spatial\\index”{R-spatial}nastąpił po przyznaniu przez konsorcjum R grantu na opracowanie wsparcia dla*prostych funkcji*, otwartego standardu i modelu do przechowywania i uzyskiwania dostępu do geometrii wektorowej.
Efektem tego było stworzeniepakietu**sf**(omówionego w sekcji @ref(intro-sf)).
Wiele miejsc odzwierciedla ogromne zainteresowanie**sf**.
Dotyczy to zwłaszcza[archiwów](https://stat.ethz.ch/pipermail/r-sig-geo/)[R-sig-Geo](https://stat.ethz.ch/pipermail/r-sig-geo/), długoletniej listy e-mailowej o otwartym dostępie, zawierającej wiele wiedzy na temat R-spatial zgromadzonej przez lata.

```{r cranlogs, fig.cap="Downloads of selected R packages for working with geographic data from early 2013 to present. The y axis shows the average number of daily downloads from the popular cloud.r-project.org CRAN mirror with a 91-day rolling window (log scale).", echo=FALSE, fig.scap="The popularity of spatial packages in R."}
knitr::include_graphics("images/01-cranlogs.png")
```

Warto zauważyć, że zmiany w szerszej społeczności R, których przykładem jest pakiet do przetwarzania danych**dplyr**(wydany w[2014 r.](https://cran.r-project.org/src/contrib/Archive/dplyr/)), wpłynęły na zmiany w ekosystemie przestrzennym R.
Wraz z innymi pakietami, które mają wspólny styl i kładą nacisk na „uporządkowane dane” (w tym np.**ggplot2**),**dplyr**został umieszczony w „metapakiecie”**tidyverse**\\index{tidyverse (package)}pod koniec[2016 r](https://cran.r-project.org/src/contrib/Archive/tidyverse/).
Podejście{tidyverse (package)}**tidyverse**\\index, skupiające się na danych w długiej formie i szybkich, intuicyjnie nazwanych funkcjach, stało się niezwykle popularne.
Doprowadziło to do popytu na „uporządkowane dane geograficzne”, który został częściowo zaspokojony przez**sf**.
Oczywistą cechą**tidyverse**jest tendencja pakietów do harmonijnej współpracy.Nie
ma odpowiednika „geoverse”, ale nowoczesny ekosystem R-spatial skonsolidował się wokół**sf**, co ilustrują kluczowe pakiety zależne od niego, przedstawione w tabeli @ref(tab:revdep), oraz**terra**, które są omawiane w niniejszej książce.
Stos jest wysoce interoperacyjny zarówno między pakietami, jak i z innymi językami, jak opisano w rozdziale @ref(gis).

```{r revdep, echo=FALSE, message=FALSE}
top_dls = readr::read_csv("extdata/top_dls.csv")
knitr::kable(top_dls[1:5, 1:2], digits = 0, 
             caption = paste("The top 5 most downloaded packages that depend", 
                             "on sf, in terms of average number of downloads", 
                             "per day over the previous month. As of",
                             min(top_dls$date), ", there are ", nrow(top_dls), 
                             " packages which import sf."), 
             caption.short = "Top 5 most downloaded packages depending on sf.",
             booktabs = TRUE,
             col.names = c("Package", "Downloads"))
# cranlogs::cran_top_downloads(when = "last-month") # most downloaded pkgs
```

## Historia R-spatial

Korzystanie z nowoczesnych pakietów przestrzennych,takich jak**sf**,ma wiele zalet, ale warto również poznać historię możliwości przestrzennych języka R.
Wiele funkcji, przypadków użycia i materiałów dydaktycznych znajduje się w starszych pakietach, z których wiele jest nadal przydatnych, pod warunkiem, że wiadomo, gdzie ich szukać.
{R!history}
@index@index

Możliwości

{R-spatial!history}

przestrzenne języka R mają swoje źródło we wczesnych pakietach przestrzennych w języku S [@bivand_implementing_2000] .
@index{S}
W latach 90. opracowano wiele skryptów S i kilka pakietów do statystyki przestrzennej @index{statistics}.
 Do roku 2000 powstały pakiety R dla różnych metod przestrzennych, w tym „analizy wzorców punktowych, geostatystyki, eksploracyjnej analizy danych przestrzennych i ekonometrii przestrzennej” [@bivand_open_2000] .
Niektóre z nich, w szczególności**spatial**,**sgeostat**i**splancs,**są nadal dostępne w CRAN\\index{CRAN} [@rowlingson_splancs_1993; @rowlingson_splancs_2017;@venables_modern_2002; @majure_sgeostat_2016] .
Kluczowe pakiety przestrzenne zostały opisane w @ripley\_spatial\_2001, który przedstawiał pakiety R do wygładzania i interpolacji przestrzennej oraz analizy wzorców punktowych.
Jeden z nich (**spatstat**) jest nadal aktywnie utrzymywany, ponad 20 lat po pierwszym wydaniu.

W kolejnym komentarzu nakreślono perspektywy statystyki [@bivand_more_2001] przestrzennej , przygotowując grunt pod rozwój popularnego pakietu**spdep** [@bivand_spdep_2017] .W komentarzu
wspomniano w szczególności o potrzebie standaryzacji interfejsów przestrzennych, wydajnych mechanizmów wymiany danych z GIS\\index{GIS}oraz obsługi metadanych przestrzennych, takich jak systemy odniesienia współrzędnych (CRS\\index{CRS}).
Cele te zostały w dużej mierze osiągnięte.

**maptools** [@bivand_maptools_2017] to kolejny ważny pakiet z tego okresu, który zapewniał interfejs dobiblioteki[shapelib](http://shapelib.maptools.org/)służącej do odczytuformatu plików{Shapefile}Shapefile\\indexi który zasilał**sp**.
W rozszerzonej recenzji pakietów przestrzennych zaproponowano system klas wspierający „obiekty danych oferowane przez GDAL”\\index{GDAL} , w tym podstawowe typy punktów, linii, wielokątów i rastrów oraz interfejsy do bibliotek zewnętrznych [@hornik_approaches_2003] .
W dużej mierze pomysły te zostały zrealizowane w pakietach**rgdal**i**sp**, stanowiących podstawę przełomowej książki*Applied Spatial Data Analysis with R* (ASDAR) [@bivand_applied_2013] , opublikowanej po raz pierwszy w 2008 roku.
Od tego czasu możliwości przestrzenne języka R znacznie się rozwinęły, ale nadal opierają się na pomysłach pionierów.
Interfejsy do GDAL\\index{GDAL}i PROJ\\indexnadal stanowią podstawę wysokowydajnychfunkcjiwejścia/wyjścia{PROJ}danych geograficznych oraztransformacji{CRS}CRS\\index w języku R, jak opisano odpowiednio w rozdziałach @ref(reproj-geo-data) i @ref(read-write).

**rgdal**, wydany w 2003 roku, zapewniłpowiązania{GDAL}GDAL\\indexdla języka R, co znacznie zwiększyło jego zdolność do importowania danych z wcześniej niedostępnych formatów danych geograficznych.
Pierwsza wersja obsługiwała tylko sterowniki rastrowe, ale kolejne ulepszenia zapewniły obsługę CRS (za pośrednictwem biblioteki PROJ), reprojekcji i importu formatów plików wektorowych.
Wiele z tych dodatkowych funkcji zostało opracowanych przez Barry'ego Rowlingsona i wydanych w baziekodu**rgdal**w 2006 r., jak opisano w @rowlingson\_rasp:\_2003 i naliście e-mailowej[R-help](https://stat.ethz.ch/pipermail/r-help/2003-January/028413.html).

Pakiet**sp**, wydany w 2005 roku, stanowił znaczący postęp w zakresie możliwości przestrzennych języka R.
Wprowadził on klasy i metody generyczne do obsługi współrzędnych geograficznych, w tym punktów, linii, wielokątów i siatek, a także danych atrybutowych.
Dzięki systemowi klas S4,**sp**przechowuje informacje, takie jak ramka ograniczająca, system odniesienia współrzędnych (CRS) i atrybuty w slotach w`Spatial`obiektach.Pozwala
to na wydajną operację na danych geograficznych.
Pakiet zapewniał również metody generyczne, takie jak`summary()`i`plot()`do pracy z danymi geograficznymi.

W ciągu następnej dekady klasy**sp** szybko zyskały popularność w zakresie danych geograficznych w języku R, a liczba pakietów, które były od nich zależne, wzrosła z około 20 w 2008 roku do ponad 100 w 2013 roku [@bivand_applied_2013] .
Do 2019 r. ponad 500 pakietów importowało**sp**.
Chociaż liczba pakietów zależnych od**sp**zmniejszyła się od czasu wydania**sf**, nadal jest on używany przez znane pakiety R, w tym**gstat**(do geostatystyki przestrzennej i czasowo-przestrzennej) \\index{spatial!statistics}oraz**geosphere** (do trygonometrii sferycznej) [@R-gstat; @hijmans_geosphere_2016] .

```{r, eval=FALSE, echo=FALSE}
# Aim: show n. pkgs that depend on sf and sp
revdep_sp = devtools::revdep(pkg = "sp")
length(revdep_sp) # 449 # 2023-11-16
revdep_sf = devtools::revdep(pkg = "sf")
length(revdep_sf) # 739 # 2023-11-16
```

Chociaż**rgdal**i**sp**rozwiązały wiele problemów przestrzennych, dopiero po opracowaniu**rgeos** w ramach projektu Google Summer of Code w 2010 r. [@R-rgeos] można było wykonywać operacje geometryczne naobiektach**sp**.
Funkcje takie jak`gIntersection()`umożliwiły użytkownikom znalezienie relacji przestrzennych między obiektami geograficznymi i modyfikowanie ich geometrii (szczegółowe informacje na temat operacji geometrycznych w**sf**można znaleźć w rozdziale @ref(geometry-operations).

\\index{raster (package)}
Ograniczeniemekosystemu**sp**było ograniczone wsparcie dla danych rastrowych.
Problem ten został rozwiązany przez**raster**\\index{raster (package)} , wydany po raz pierwszy w 2010 roku [@R-raster] .System
klas i funkcje**raster**umożliwiły szereg operacji rastrowych, które obecnie są zaimplementowane wpakiecie**terra**, zastępującym**raster**, jak opisano w sekcji @ref(raster-data).
Ważną cechą**raster**i**terra**jest ich zdolność do pracy z zestawami danych, które są zbyt duże, aby zmieścić się w pamięci RAM, dzięki obsłudze operacji poza dyskiem.
**raster**i**terra**obsługują również algebrę map, jak opisano w sekcji @ref(map-algebra).

Równolegle z rozwojem systemów klas i metod pojawiło się wsparcie dla R jako interfejsu do dedykowanego oprogramowania GIS.
**GRASS** [@bivand_using_2000] i kolejne pakiety**spgrass6**,**rgrass7**i**rgrass** były znaczącymi przykładami w tym kierunku [@bivand_rgrass7_2016;@bivand_spgrass6_2016;@R-rgrass] .
Inne przykłady mostów między R a GIS obejmują mosty do QGIS poprzez**qgisprocess** [@R-qgisprocess] , SAGA poprzez**Rsagacmd** [@R-Rsagacmd] lub**RSAGA** [@R-RSAGA] \index{RSAGA (package)}oraz ArcGIS poprzez**RPyGeo** [@brenning_arcgis_2012, opublikowane po raz pierwszy w 2008 r.] , i inne (patrz rozdział @ref(gis)).

Wizualizacja nie była początkowo przedmiotem zainteresowania, ponieważ większość rozwoju R-spatial koncentrowała się na analizie i operacjach geograficznych.
**sp**zapewniało metody tworzenia map przy użyciu zarówno systemu bazowego, jak i systemu siatkowego, ale rosło zapotrzebowanie na zaawansowane funkcje tworzenia map.
**RgoogleMaps** , wydany po raz pierwszy w 2009 r., umożliwiał nakładanie danych przestrzennych R na kafelki „mapy bazowej” z usług internetowych, takich jak Google Maps lub OpenStreetMap [@loecher_rgooglemaps_2015] .
\\index{ggplot2 (package)}
Następnie pojawił siępakiet**ggmap**,który dodał podobne możliwości kafelków „mapy bazowej” do**ggplot2** [@kahle_ggmap_2013] .
Chociaż**ggmap**ułatwił tworzenie map za pomocą**ggplot2**, jego użyteczność była ograniczona przez konieczność  obiektów`fortify`przestrzennych, co oznaczało przekształcanie ich w długie ramki danych.
Chociaż działa to dobrze w przypadku punktów, jest to nieefektywne obliczeniowo w przypadku linii i wielokątów, ponieważ każda współrzędna (wierzchołek) jest przekształcana w wiersz, co prowadzi do powstania ogromnych ramek danych reprezentujących złożone geometrie.
Chociaż wizualizacja geograficzna skupiała się zazwyczaj na danych wektorowych, wizualizacja rastrowa była obsługiwana w**rasterze**i zyskała na popularności wraz z wydaniem**rasterVis** [@lamigueiro_displaying_2018] .
Od tego czasu tworzenie map w R stało się gorącym tematem, a dedykowane pakiety, takie jak**tmap**,**leaflet**i**mapview**, zyskały popularność, co podkreślono w rozdziale @ref(adv-map).

Od 2018 r., kiedy to ukazało się pierwsze wydanie książki Geocomputation with R, rozwój pakietów geograficznych R przyspieszył. W 2020
 r [@R] . po raz pierwszy wydano**terra**, następcę{terra (package)} pakietu**raster** , [który]{raster (package)}
 przyniósł użytkownikom R pracującym z zestawami danych rastrowych kilka korzyści: jest szybszy i ma bardziej przejrzysty interfejs użytkownika niż jego poprzednik, jak opisano w sekcji @ref(raster-data).

W połowie 2021 roku**sf**zaczął używać silnika geometrii sferycznej S2 do operacji geometrycznych na nieprzekształconych zbiorach danych, jak opisano w sekcji @ref(s2).
Od 2018 roku opracowano dodatkowe sposoby reprezentowania danych geograficznych i pracy z nimi w R, w tym pakiety**stars**i
      \[@pebesma\_stars\_2021\]
    **lidR** [; @Roussel2020] .
{stars (package)}
{lidR (package)}

Takie zmiany zostały spowodowane pojawieniem się nowych technologii, standardów i oprogramowania poza środowiskiem R [@bivand_progress_2021] .
Poważne aktualizacje biblioteki PROJ\\index,{PROJ}które rozpoczęły się w 2018 r., wymusiły zastąpienie reprezentacji CRS „proj-string” reprezentacjami „Well Known Text”, jak opisano w sekcji @ref(crs-intro) i rozdziale @ref(reproj-geo-data).

\\index{rayshader (package)}
Od czasu publikacji pierwszej wersji Geocomputation with R w 2018 r. opracowano i udoskonalono kilka pakietów do wizualizacji danych przestrzennych.
 Na przykład pakiet**rayshader** umożliwia tworzenie efektownych i łatwych do animacji wizualizacji 3D za pomocą ray tracingu i wielu metod cieniowania reliefowego [@morganwall_rayshader_2021] .
\\indexBardzo{ggplot2 (package)}
popularnypakiet**ggplot2**zyskał nowe możliwości przestrzenne dzięki pracy nad pakietem**ggspatial** , który zapewnia skale i strzałki północne [@dunnington_ggspatial_2021] .
**gganimate** umożliwia płynne i konfigurowalne animacje przestrzenne [@pedersen_gganimate_2020] .

Istniejące pakiety wizualizacyjne również zostały ulepszone lub przepisane.
Duże obiekty rastrowe są automatycznie zmniejszane w**tmap**, a dzięki pakietom takim jak**leafgl**i**mapdeck**możliwe jest teraz tworzenie wysokowydajnych interaktywnych map.

<!-- TODO: dodać datę wydania tmap 4.0, gdy będzie gotowy -->

Pakiet**mapsf**(następca**cartography** ) został przepisany w celu zmniejszenia zależności i poprawy wydajności [@giraud_mapsf_2021] , a**tmap**przeszedł znaczną aktualizację w wersji 4, w której poprawiono większość wewnętrznego kodu.

Pod koniec 2021 r.[ogłoszono](https://stat.ethz.ch/pipermail/r-sig-geo/2021-September/028760.html)planowane wycofanie**rgdal**,**rgeos**i**maptools**,a w październiku 2023 r. zostały one zarchiwizowane w CRAN.Wycofanie
tych pakietów pod koniec 2023 r. miało nie tylko duży wpływ na istniejące przepływy pracy wykorzystujące te pakiety, ale także[wpłynęło na pakiety, które są od nich zależne](https://geocompx.org/post/2023/rgdal-retirement/).
Nowoczesne pakiety R,takie jak**sf**i**terra**, opisane w rozdziale @ref(spatial-class), stanowią solidną i przyszłościową podstawę dla geocomputation, na której opieramy się w tej książce.

## Ćwiczenia

```{r, echo=FALSE, results="asis"}
res = knitr::knit_child('_01-ex.Rmd', quiet = TRUE, options = list(include = FALSE, eval = FALSE))
cat(res, sep = '\n')
```


